{% schema %}
{
  "name": "Flash Sale",
  "tag": "section",
  "class": "section-flash-sale",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Flash Sale"
    },
    {
      "type": "text",
      "id": "end_date",
      "label": "End Date (YYYY-MM-DD)",
      "info": "Example: 2026-12-31"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "id": "product_limit",
      "min": 4,
      "max": 12,
      "step": 1,
      "default": 6,
      "label": "Product Limit"
    }
  ],
  "presets": [
    {
      "name": "Flash Sale"
    }
  ]
}
{% endschema %}

<div class="crimson-zone section-padding">
  <div class="container">
    <div class="crimson-zone-header flex items-center justify-between mb-4">
      <div class="flex items-center gap-3">
         <div class="flash-icon text-red">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>
        </div>
        <h2 class="text-2xl font-heading font-bold text-primary">{{ section.settings.heading }}</h2>
      </div>
      
      {% if section.settings.end_date != blank %}
        <div class="flash-timer flex items-center gap-2" data-end-time="{{ section.settings.end_date }}">
           <div class="timer-block bg-white p-2 text-center rounded">
              <span class="block font-bold text-lg hours">00</span>
              <span class="text-xs text-muted">HRS</span>
           </div>
           <span class="font-bold">:</span>
           <div class="timer-block bg-white p-2 text-center rounded">
              <span class="block font-bold text-lg minutes">00</span>
              <span class="text-xs text-muted">MIN</span>
           </div>
           <span class="font-bold">:</span>
           <div class="timer-block bg-white p-2 text-center rounded">
              <span class="block font-bold text-lg seconds">00</span>
              <span class="text-xs text-muted">SEC</span>
           </div>
        </div>
      {% endif %}
    </div>

    <div class="crimson-products-scroll horizontal-scroll" style="gap: 16px; padding-bottom: 20px;">
      {% assign collection = collections[section.settings.collection] %}
      {% if collection != blank %}
        {% for product in collection.products limit: section.settings.product_limit %}
          {% render 'product-card', product: product, class: 'w-60 flex-shrink-0' %}
        {% endfor %}
      {% else %}
         <!-- Empty placeholder -->
         {% for i in (1..4) %}
            <div class="w-60 flex-shrink-0 bg-white p-2 rounded shadow-sm">
               {{ 'product-' | append: i | placeholder_svg_tag }}
               <p class="font-bold mt-2">Example Product</p>
               <p class="text-red">â‚¹1,999</p>
            </div>
         {% endfor %}
      {% endif %}
    </div>
  </div>
</div>

<style>
.crimson-zone {
  background: linear-gradient(135deg, #FFF5F5 0%, #FFFFFF 100%);
  border-top: 1px solid #FFE0E0;
  border-bottom: 1px solid #FFE0E0;
}
.flash-icon { animation: pulse 1.5s infinite; }
@keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
</style>
